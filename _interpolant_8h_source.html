<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>GalSim: include/galsim/Interpolant.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>include/galsim/Interpolant.h</h1><a href="_interpolant_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* -*- c++ -*-</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright 2012-2014 The GalSim developers:</span>
<a name="l00003"></a>00003 <span class="comment"> * https://github.com/GalSim-developers</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * This file is part of GalSim: The modular galaxy image simulation toolkit.</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> * GalSim is free software: you can redistribute it and/or modify</span>
<a name="l00008"></a>00008 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l00009"></a>00009 <span class="comment"> * the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00010"></a>00010 <span class="comment"> * (at your option) any later version.</span>
<a name="l00011"></a>00011 <span class="comment"> *</span>
<a name="l00012"></a>00012 <span class="comment"> * GalSim is distributed in the hope that it will be useful,</span>
<a name="l00013"></a>00013 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00014"></a>00014 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00015"></a>00015 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00018"></a>00018 <span class="comment"> * along with GalSim.  If not, see &lt;http://www.gnu.org/licenses/&gt;</span>
<a name="l00019"></a>00019 <span class="comment"> */</span>
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="preprocessor">#ifndef INTERPOLANT_H</span>
<a name="l00022"></a>00022 <span class="preprocessor"></span><span class="preprocessor">#define INTERPOLANT_H</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00025"></a><a class="code" href="_interpolant_8h.html#ae23b24e85d04f74fdebd21fe0cc0ebcf">00025</a> <span class="preprocessor">#define BOOST_NO_CXX11_SMART_PTR</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="preprocessor">#include &lt;boost/shared_ptr.hpp&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;map&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;Std.h&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="_table_8h.html">Table.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="_random_8h.html" title="Random-number-generator classes.">Random.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="_photon_array_8h.html" title="Contains a class definition for lists of photons from &amp;quot;shooting.&amp;quot;.">PhotonArray.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="_one_dimensional_deviate_8h.html">OneDimensionalDeviate.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="_s_b_profile_8h.html" title="Contains a class definition for two-dimensional Surface Brightness Profiles.">SBProfile.h</a>&quot;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="keyword">namespace </span>galsim {
<a name="l00037"></a>00037 
<a name="l00038"></a>00038     <span class="keyword">class </span>Interpolant;
<a name="l00039"></a>00039 
<a name="l00044"></a><a class="code" href="classgalsim_1_1_interpolant_function.html">00044</a>     <span class="keyword">class </span><a class="code" href="classgalsim_1_1_interpolant_function.html" title="Class to interface an interpolant to the `OneDimensionalDeviate` class for photon-shooting...">InterpolantFunction</a>: <span class="keyword">public</span> <a class="code" href="classgalsim_1_1_flux_density.html" title="An interface class for functions giving differential flux vs x or r.">FluxDensity</a> {
<a name="l00045"></a>00045     <span class="keyword">public</span>:
<a name="l00046"></a><a class="code" href="classgalsim_1_1_interpolant_function.html#a03cc4a47c21c9e59d3da721d5530b536">00046</a>         <a class="code" href="classgalsim_1_1_interpolant_function.html#a03cc4a47c21c9e59d3da721d5530b536">InterpolantFunction</a>(<span class="keyword">const</span> <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a>&amp; interp): _interp(interp) {}
<a name="l00047"></a>00047         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_function.html#a44c254a987069446cc23d980d421c0d5" title="Interface requires implementation of operator().">operator()</a>(<span class="keywordtype">double</span> x) <span class="keyword">const</span>; <span class="comment">// returns the xval() of the `Interpolant`</span>
<a name="l00048"></a><a class="code" href="classgalsim_1_1_interpolant_function.html#aa4a7eb12e9c785f47b97ce724d31bd15">00048</a>         <a class="code" href="classgalsim_1_1_interpolant_function.html#aa4a7eb12e9c785f47b97ce724d31bd15">~InterpolantFunction</a>() {}
<a name="l00049"></a>00049     <span class="keyword">private</span>:
<a name="l00050"></a>00050         <span class="keyword">const</span> <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a>&amp; _interp;  <span class="comment">// Interpolant being wrapped</span>
<a name="l00051"></a>00051     };
<a name="l00052"></a>00052 
<a name="l00062"></a><a class="code" href="classgalsim_1_1_interpolant.html">00062</a>     <span class="keyword">class </span><a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a> 
<a name="l00063"></a>00063     {
<a name="l00064"></a>00064     <span class="keyword">public</span>:
<a name="l00070"></a><a class="code" href="classgalsim_1_1_interpolant.html#ac53d9d60c405e3986dae5ab23e0ff0d9">00070</a>         <a class="code" href="classgalsim_1_1_interpolant.html#ac53d9d60c405e3986dae5ab23e0ff0d9" title="Constructor.">Interpolant</a>(<span class="keyword">const</span> <a class="code" href="structgalsim_1_1_g_s_params_ptr.html">GSParamsPtr</a>&amp; gsparams) : _gsparams(gsparams), _interp(*this) {}
<a name="l00071"></a>00071 
<a name="l00073"></a><a class="code" href="classgalsim_1_1_interpolant.html#a969646312c2a84af20ccc7a50d15bcf0">00073</a>         <a class="code" href="classgalsim_1_1_interpolant.html#a969646312c2a84af20ccc7a50d15bcf0" title="Copy constructor: does not copy photon sampler, will need to rebuild.">Interpolant</a>(<span class="keyword">const</span> <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a>&amp; rhs): _gsparams(rhs._gsparams), _interp(rhs._interp) {}
<a name="l00074"></a>00074 
<a name="l00076"></a><a class="code" href="classgalsim_1_1_interpolant.html#a40b4d4b5e852eb49767c10a28a8ac134">00076</a>         <span class="keyword">virtual</span> <a class="code" href="classgalsim_1_1_interpolant.html#a40b4d4b5e852eb49767c10a28a8ac134" title="Destructor.">~Interpolant</a>() {}
<a name="l00077"></a>00077 
<a name="l00082"></a>00082         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant.html#aa9e39bd533affaec3b6b5f09d438720d" title="Maximum extent of interpolant from origin in x space (pixels).">xrange</a>() <span class="keyword">const</span> =0;
<a name="l00083"></a>00083 
<a name="l00087"></a>00087         <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classgalsim_1_1_interpolant.html#a1b45f4b5215b037a0a45116e36d8ec53" title="The total range as an integer. Typically xrange() == 0.5 * ixrange().">ixrange</a>() <span class="keyword">const</span> =0;
<a name="l00088"></a>00088 
<a name="l00093"></a>00093         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant.html#a58342cbe81ae5746949c69cebea66736" title="Maximum extent of interpolant from origin in u space (cycles per pixel).">urange</a>() <span class="keyword">const</span> =0;
<a name="l00094"></a>00094 
<a name="l00099"></a>00099         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant.html#a7497e5bdb380c8b0dda2c2265db25298" title="Report a generic indication of the accuracy to which Interpolant is calculated.">getTolerance</a>() <span class="keyword">const</span> =0;  <span class="comment">// report target accuracy</span>
<a name="l00100"></a>00100 
<a name="l00106"></a>00106         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant.html#a790f65f6483f68bc5acea3398d301200" title="Value of interpolant in real space.">xval</a>(<span class="keywordtype">double</span> x) <span class="keyword">const</span> =0;
<a name="l00107"></a>00107 
<a name="l00116"></a>00116         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant.html#a7046be7078e02c0671b778a2b1ac7c18" title="Value of interpolant, wrapped at period N.">xvalWrapped</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> N) <span class="keyword">const</span>;
<a name="l00117"></a>00117 
<a name="l00124"></a>00124         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant.html#a310b3504bdb27d02f6d27e5f1b5c33e1" title="Value of interpolant in frequency space.">uval</a>(<span class="keywordtype">double</span> u) <span class="keyword">const</span> =0;
<a name="l00125"></a>00125 
<a name="l00134"></a><a class="code" href="classgalsim_1_1_interpolant.html#ac83a270c0e9faa73f8997c5ff6e1a6e2">00134</a>         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classgalsim_1_1_interpolant.html#ac83a270c0e9faa73f8997c5ff6e1a6e2" title="Report whether interpolation will reproduce values at samples.">isExactAtNodes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; }
<a name="l00135"></a>00135 
<a name="l00137"></a>00137 
<a name="l00145"></a><a class="code" href="classgalsim_1_1_interpolant.html#a3f4c8d074b6e00e6dd70b56f12434b79">00145</a>         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant.html#a3f4c8d074b6e00e6dd70b56f12434b79" title="Return the integral of the positive portions of the kernel.">getPositiveFlux</a>()<span class="keyword"> const </span>
<a name="l00146"></a>00146 <span class="keyword">        </span>{ checkSampler(); <span class="keywordflow">return</span> _sampler-&gt;getPositiveFlux(); }
<a name="l00147"></a>00147 
<a name="l00156"></a><a class="code" href="classgalsim_1_1_interpolant.html#a5254f33308527de5bda9dbc23f593bb5">00156</a>         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant.html#a5254f33308527de5bda9dbc23f593bb5" title="Return the (absolute value of) integral of the negative portions of the kernel.">getNegativeFlux</a>()<span class="keyword"> const </span>
<a name="l00157"></a>00157 <span class="keyword">        </span>{ checkSampler(); <span class="keywordflow">return</span> _sampler-&gt;getNegativeFlux(); }
<a name="l00158"></a>00158 
<a name="l00172"></a><a class="code" href="classgalsim_1_1_interpolant.html#a055244edbe878d1e19c76b9b02442be1">00172</a>         <span class="keyword">virtual</span> boost::shared_ptr&lt;PhotonArray&gt; <a class="code" href="classgalsim_1_1_interpolant.html#a055244edbe878d1e19c76b9b02442be1" title="Return array of displacements drawn from this kernel.">shoot</a>(<span class="keywordtype">int</span> N, <a class="code" href="classgalsim_1_1_uniform_deviate.html" title="Pseudo-random number generator with uniform distribution in interval [0.,1.).">UniformDeviate</a> ud)<span class="keyword"> const </span>
<a name="l00173"></a>00173 <span class="keyword">        </span>{ checkSampler(); <span class="keywordflow">return</span> _sampler-&gt;shoot(N, ud); }
<a name="l00174"></a>00174 
<a name="l00175"></a>00175     <span class="keyword">protected</span>:
<a name="l00176"></a>00176 
<a name="l00177"></a>00177         <span class="keyword">const</span> <a class="code" href="structgalsim_1_1_g_s_params_ptr.html">GSParamsPtr</a> _gsparams;
<a name="l00178"></a>00178         <a class="code" href="classgalsim_1_1_interpolant_function.html" title="Class to interface an interpolant to the `OneDimensionalDeviate` class for photon-shooting...">InterpolantFunction</a> _interp;
<a name="l00179"></a>00179 
<a name="l00180"></a>00180         <span class="comment">// Class that draws photons from this Interpolant</span>
<a name="l00181"></a>00181         <span class="keyword">mutable</span> boost::shared_ptr&lt;OneDimensionalDeviate&gt; _sampler;  
<a name="l00182"></a>00182 
<a name="l00183"></a>00183         <span class="comment">// Allocate photon sampler and do all of its pre-calculations</span>
<a name="l00184"></a>00184         <span class="keyword">virtual</span> <span class="keywordtype">void</span> checkSampler()<span class="keyword"> const </span>
<a name="l00185"></a>00185 <span class="keyword">        </span>{
<a name="l00186"></a>00186             <span class="keywordflow">if</span> (_sampler.get()) <span class="keywordflow">return</span>;
<a name="l00187"></a>00187             <span class="comment">// Will assume by default that the Interpolant kernel changes sign at non-zero</span>
<a name="l00188"></a>00188             <span class="comment">// integers, with one extremum in each integer range.</span>
<a name="l00189"></a>00189             <span class="keywordtype">int</span> nKnots = int(ceil(<a class="code" href="classgalsim_1_1_interpolant.html#aa9e39bd533affaec3b6b5f09d438720d" title="Maximum extent of interpolant from origin in x space (pixels).">xrange</a>()));
<a name="l00190"></a>00190             std::vector&lt;double&gt; ranges(2*nKnots);
<a name="l00191"></a>00191             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i&lt;=nKnots; i++) {
<a name="l00192"></a>00192                 <span class="keywordtype">double</span> knot = std::min(<span class="keywordtype">double</span>(i), <a class="code" href="classgalsim_1_1_interpolant.html#aa9e39bd533affaec3b6b5f09d438720d" title="Maximum extent of interpolant from origin in x space (pixels).">xrange</a>());
<a name="l00193"></a>00193                 ranges[nKnots-i] = -knot;
<a name="l00194"></a>00194                 ranges[nKnots+i-1] = knot;
<a name="l00195"></a>00195             }
<a name="l00196"></a>00196             _sampler.reset(<span class="keyword">new</span> OneDimensionalDeviate(_interp, ranges, <span class="keyword">false</span>, _gsparams));
<a name="l00197"></a>00197         }
<a name="l00198"></a>00198     };
<a name="l00199"></a>00199 
<a name="l00205"></a><a class="code" href="classgalsim_1_1_interpolant2d.html">00205</a>     <span class="keyword">class </span><a class="code" href="classgalsim_1_1_interpolant2d.html" title="Two-dimensional version of the `Interpolant` interface.">Interpolant2d</a> 
<a name="l00206"></a>00206     {
<a name="l00207"></a>00207     <span class="keyword">public</span>:
<a name="l00208"></a><a class="code" href="classgalsim_1_1_interpolant2d.html#a69071346853f9c649022de9672413a4f">00208</a>         <a class="code" href="classgalsim_1_1_interpolant2d.html#a69071346853f9c649022de9672413a4f">Interpolant2d</a>() {}
<a name="l00209"></a><a class="code" href="classgalsim_1_1_interpolant2d.html#abbac2e6d4a0d470010144c93bcd062c6">00209</a>         <span class="keyword">virtual</span> <a class="code" href="classgalsim_1_1_interpolant2d.html#abbac2e6d4a0d470010144c93bcd062c6">~Interpolant2d</a>() {}
<a name="l00210"></a>00210 
<a name="l00211"></a>00211         <span class="comment">// Ranges are assumed to be same in x as in y.</span>
<a name="l00212"></a>00212         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant2d.html#a98c7a657536289786c62825bb27dfc2b">xrange</a>() <span class="keyword">const</span>=0;
<a name="l00213"></a>00213         <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classgalsim_1_1_interpolant2d.html#a7ffeb92d0aeb9eb802d9765aee2063d8">ixrange</a>() <span class="keyword">const</span>=0;
<a name="l00214"></a>00214         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant2d.html#a05f192440db6215c723f85f16c25716d">urange</a>() <span class="keyword">const</span>=0;
<a name="l00215"></a>00215         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant2d.html#ae873289351ec42d4faa425cc204c8940">getTolerance</a>() <span class="keyword">const</span>=0;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant2d.html#a17cba4496dec0fd04d629d44751e5fb6">xval</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y) <span class="keyword">const</span>=0;
<a name="l00218"></a>00218         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant2d.html#a2d4fbd8165401d73994bebb4ba79138b">xvalWrapped</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">int</span> N) <span class="keyword">const</span>=0;
<a name="l00219"></a>00219         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant2d.html#aa6aa994974a584f1c17d8d91eec8da78">uval</a>(<span class="keywordtype">double</span> u, <span class="keywordtype">double</span> v) <span class="keyword">const</span>=0;
<a name="l00220"></a>00220         <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classgalsim_1_1_interpolant2d.html#ab3571b6a9f27bf08b48e7966f4ec9e15">isExactAtNodes</a>() <span class="keyword">const</span>=0;
<a name="l00221"></a>00221 
<a name="l00222"></a>00222         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant2d.html#afbf05b6aad3771c792af8b1fa547ec9a">getPositiveFlux</a>() <span class="keyword">const</span>=0;
<a name="l00223"></a>00223         <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant2d.html#ae6ecd17597bda6f5ef45679e3a7a2955">getNegativeFlux</a>() <span class="keyword">const</span>=0;
<a name="l00224"></a>00224         <span class="keyword">virtual</span> boost::shared_ptr&lt;PhotonArray&gt; <a class="code" href="classgalsim_1_1_interpolant2d.html#aafe7e08f2e4d4ed371a6e5c8703198f0">shoot</a>(<span class="keywordtype">int</span> N, <a class="code" href="classgalsim_1_1_uniform_deviate.html" title="Pseudo-random number generator with uniform distribution in interval [0.,1.).">UniformDeviate</a> ud) <span class="keyword">const</span>=0;
<a name="l00225"></a>00225     };
<a name="l00226"></a>00226 
<a name="l00233"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html">00233</a>     <span class="keyword">class </span><a class="code" href="classgalsim_1_1_interpolant_x_y.html" title="An interpolant that is product of same 1d `Interpolant` in x and y.">InterpolantXY</a> : <span class="keyword">public</span> <a class="code" href="classgalsim_1_1_interpolant2d.html" title="Two-dimensional version of the `Interpolant` interface.">Interpolant2d</a> 
<a name="l00234"></a>00234     {
<a name="l00235"></a>00235     <span class="keyword">public</span>:
<a name="l00236"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#a5f1957e377106ba42fffa1c69299bf0d">00236</a>         <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a5f1957e377106ba42fffa1c69299bf0d">InterpolantXY</a>(boost::shared_ptr&lt;Interpolant&gt; i1d) : _i1d(i1d) {}
<a name="l00237"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#a9c311e14dd472726f38b68195cba9ebe">00237</a>         <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a9c311e14dd472726f38b68195cba9ebe">~InterpolantXY</a>() {}
<a name="l00238"></a>00238 
<a name="l00239"></a>00239         <span class="comment">// All of the calls below implement base class methods.</span>
<a name="l00240"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#a8286552519f7b9d2406474a5af44cf25">00240</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a8286552519f7b9d2406474a5af44cf25">xrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _i1d-&gt;xrange(); }
<a name="l00241"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#a5fc0268199308fc3801f91751bfa199b">00241</a>         <span class="keywordtype">int</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a5fc0268199308fc3801f91751bfa199b">ixrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _i1d-&gt;ixrange(); }
<a name="l00242"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#a6d9cc160149d56af93c990beda6e2d64">00242</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a6d9cc160149d56af93c990beda6e2d64">urange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _i1d-&gt;urange(); }
<a name="l00243"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#adde3b9c001dc5da0f8a6d214bbe2a88d">00243</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#adde3b9c001dc5da0f8a6d214bbe2a88d">getTolerance</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _i1d-&gt;getTolerance(); }
<a name="l00244"></a>00244 
<a name="l00245"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#a6d407ec889c38cd236e89b16e111a9ba">00245</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a6d407ec889c38cd236e89b16e111a9ba">xval</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _i1d-&gt;xval(x)*_i1d-&gt;xval(y); }
<a name="l00246"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#a4bba7385c315044275c792b882047676">00246</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a4bba7385c315044275c792b882047676">xvalWrapped</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">int</span> N)<span class="keyword"> const </span>
<a name="l00247"></a>00247 <span class="keyword">        </span>{ <span class="keywordflow">return</span> _i1d-&gt;xvalWrapped(x,N)*_i1d-&gt;xvalWrapped(y,N); }
<a name="l00248"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#aef508b3d692c2898602c54b458da0b09">00248</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#aef508b3d692c2898602c54b458da0b09">uval</a>(<span class="keywordtype">double</span> u, <span class="keywordtype">double</span> v)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _i1d-&gt;uval(u)*_i1d-&gt;uval(v); }
<a name="l00249"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#aab85dd715394156a1465310d24be809e">00249</a>         <span class="keywordtype">bool</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#aab85dd715394156a1465310d24be809e">isExactAtNodes</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _i1d-&gt;isExactAtNodes(); }
<a name="l00250"></a>00250 
<a name="l00251"></a>00251         <span class="comment">// Photon-shooting routines:</span>
<a name="l00252"></a>00252         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a980685f622a218887cfbc2afa4dc4f45">getPositiveFlux</a>() <span class="keyword">const</span>;
<a name="l00253"></a>00253         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a83494ba027d748c1030a22f348da0a1d">getNegativeFlux</a>() <span class="keyword">const</span>;
<a name="l00254"></a>00254         boost::shared_ptr&lt;PhotonArray&gt; <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a17c8bb0e37634be9d53193f77f95bb95">shoot</a>(<span class="keywordtype">int</span> N, <a class="code" href="classgalsim_1_1_uniform_deviate.html" title="Pseudo-random number generator with uniform distribution in interval [0.,1.).">UniformDeviate</a> ud) <span class="keyword">const</span>;
<a name="l00255"></a>00255 
<a name="l00256"></a>00256         <span class="comment">// Access the 1d interpolant functions for more efficient 2d interps:</span>
<a name="l00257"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#a51912569d07b24e13b9cb2e4821e3ed0">00257</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a51912569d07b24e13b9cb2e4821e3ed0">xval1d</a>(<span class="keywordtype">double</span> x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _i1d-&gt;xval(x); }
<a name="l00258"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#a5e74a5e54e9a2b9017ba6b156ca14321">00258</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a5e74a5e54e9a2b9017ba6b156ca14321">xvalWrapped1d</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> N)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _i1d-&gt;xvalWrapped(x,N); }
<a name="l00259"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#aed11704164e8f9ddf889a4b90d234c70">00259</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_interpolant_x_y.html#aed11704164e8f9ddf889a4b90d234c70">uval1d</a>(<span class="keywordtype">double</span> u)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _i1d-&gt;uval(u); }
<a name="l00260"></a><a class="code" href="classgalsim_1_1_interpolant_x_y.html#a83205da9117bf4b66ab2d9fd5aa7b585">00260</a>         <span class="keyword">const</span> <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a>* <a class="code" href="classgalsim_1_1_interpolant_x_y.html#a83205da9117bf4b66ab2d9fd5aa7b585">get1d</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _i1d.get(); }
<a name="l00261"></a>00261 
<a name="l00262"></a>00262     <span class="keyword">private</span>:
<a name="l00263"></a>00263         boost::shared_ptr&lt;Interpolant&gt; _i1d;  <span class="comment">// The 1d function used in both axes here.</span>
<a name="l00264"></a>00264     };
<a name="l00265"></a>00265 
<a name="l00277"></a><a class="code" href="classgalsim_1_1_delta.html">00277</a>     <span class="keyword">class </span><a class="code" href="classgalsim_1_1_delta.html" title="Delta-function interpolant in 1d.">Delta</a> : <span class="keyword">public</span> <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a> 
<a name="l00278"></a>00278     {
<a name="l00279"></a>00279     <span class="keyword">public</span>:
<a name="l00287"></a><a class="code" href="classgalsim_1_1_delta.html#ae4b30adde2b8257ce2eb2e161acfe61b">00287</a>         <a class="code" href="classgalsim_1_1_delta.html#ae4b30adde2b8257ce2eb2e161acfe61b" title="Constructor.">Delta</a>(<span class="keywordtype">double</span> width=1.e-3, <span class="keyword">const</span> <a class="code" href="structgalsim_1_1_g_s_params_ptr.html">GSParamsPtr</a>&amp; gsparams=<a class="code" href="structgalsim_1_1_g_s_params_ptr.html#acbdc82aaaa6f7e7245f2996da8045d2b">GSParamsPtr::getDefault</a>()) : 
<a name="l00288"></a>00288             <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a>(gsparams), _width(width) {}
<a name="l00289"></a><a class="code" href="classgalsim_1_1_delta.html#a334fca891d6ea20c7c10b9345224c886">00289</a>         <a class="code" href="classgalsim_1_1_delta.html#a334fca891d6ea20c7c10b9345224c886">~Delta</a>() {}
<a name="l00290"></a>00290 
<a name="l00291"></a><a class="code" href="classgalsim_1_1_delta.html#ac4290762dcb406a8152aa5efc270d2b2">00291</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_delta.html#ac4290762dcb406a8152aa5efc270d2b2" title="Maximum extent of interpolant from origin in x space (pixels).">xrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0.; }
<a name="l00292"></a><a class="code" href="classgalsim_1_1_delta.html#a2357b55b7a27fec753175111e2696ad7">00292</a>         <span class="keywordtype">int</span> <a class="code" href="classgalsim_1_1_delta.html#a2357b55b7a27fec753175111e2696ad7" title="The total range as an integer. Typically xrange() == 0.5 * ixrange().">ixrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00293"></a><a class="code" href="classgalsim_1_1_delta.html#a44537fa1050275ebd8075b2617e0e782">00293</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_delta.html#a44537fa1050275ebd8075b2617e0e782" title="Maximum extent of interpolant from origin in u space (cycles per pixel).">urange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1./_width; }
<a name="l00294"></a><a class="code" href="classgalsim_1_1_delta.html#ae8b671470508cc78995ab27a016b8179">00294</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_delta.html#ae8b671470508cc78995ab27a016b8179" title="Report a generic indication of the accuracy to which Interpolant is calculated.">getTolerance</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _width; }
<a name="l00295"></a>00295 
<a name="l00296"></a><a class="code" href="classgalsim_1_1_delta.html#ac78ba5f419f55f65075bd8046c4f7f4a">00296</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_delta.html#ac78ba5f419f55f65075bd8046c4f7f4a" title="Value of interpolant in real space.">xval</a>(<span class="keywordtype">double</span> x)<span class="keyword"> const </span>
<a name="l00297"></a>00297 <span class="keyword">        </span>{
<a name="l00298"></a>00298             <span class="keywordflow">if</span> (std::abs(x)&gt;0.5*_width) <span class="keywordflow">return</span> 0.;
<a name="l00299"></a>00299             <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1./_width;
<a name="l00300"></a>00300         }
<a name="l00301"></a><a class="code" href="classgalsim_1_1_delta.html#aba9f24330b78cba78e42e22317e491a3">00301</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_delta.html#aba9f24330b78cba78e42e22317e491a3" title="Value of interpolant in frequency space.">uval</a>(<span class="keywordtype">double</span> u)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1.; }
<a name="l00302"></a>00302 
<a name="l00303"></a>00303         <span class="comment">// Override the default numerical photon-shooting method</span>
<a name="l00304"></a><a class="code" href="classgalsim_1_1_delta.html#a820cd9ae75383e9181d51aa318db60e7">00304</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_delta.html#a820cd9ae75383e9181d51aa318db60e7" title="Return the integral of the positive portions of the kernel.">getPositiveFlux</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1.; }
<a name="l00305"></a><a class="code" href="classgalsim_1_1_delta.html#aeea3fd7880172d0306276df86e561f85">00305</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_delta.html#aeea3fd7880172d0306276df86e561f85" title="Return the (absolute value of) integral of the negative portions of the kernel.">getNegativeFlux</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0.; }
<a name="l00306"></a>00306         boost::shared_ptr&lt;PhotonArray&gt; <a class="code" href="classgalsim_1_1_delta.html#a1e56188f7100f4b605c8442b53dbe9c4" title="Return array of displacements drawn from this kernel.">shoot</a>(<span class="keywordtype">int</span> N, <a class="code" href="classgalsim_1_1_uniform_deviate.html" title="Pseudo-random number generator with uniform distribution in interval [0.,1.).">UniformDeviate</a> ud) <span class="keyword">const</span>;
<a name="l00307"></a>00307 
<a name="l00308"></a>00308     <span class="keyword">private</span>:
<a name="l00309"></a>00309         <span class="keywordtype">double</span> _width;
<a name="l00310"></a>00310     };
<a name="l00311"></a>00311 
<a name="l00323"></a><a class="code" href="classgalsim_1_1_nearest.html">00323</a>     <span class="keyword">class </span><a class="code" href="classgalsim_1_1_nearest.html" title="Nearest-neighbor interpolation: boxcar.">Nearest</a> : <span class="keyword">public</span> <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a> 
<a name="l00324"></a>00324     {
<a name="l00325"></a>00325     <span class="keyword">public</span>:
<a name="l00333"></a><a class="code" href="classgalsim_1_1_nearest.html#ac110b5a7e420c6a6edd982047edd59bf">00333</a>         <a class="code" href="classgalsim_1_1_nearest.html#ac110b5a7e420c6a6edd982047edd59bf" title="Constructor.">Nearest</a>(<span class="keywordtype">double</span> tol=1.e-3, <span class="keyword">const</span> <a class="code" href="structgalsim_1_1_g_s_params_ptr.html">GSParamsPtr</a>&amp; gsparams=<a class="code" href="structgalsim_1_1_g_s_params_ptr.html#acbdc82aaaa6f7e7245f2996da8045d2b">GSParamsPtr::getDefault</a>()) :
<a name="l00334"></a>00334             <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a>(gsparams), _tolerance(tol) {}
<a name="l00335"></a><a class="code" href="classgalsim_1_1_nearest.html#ab73d3adcb493f8639ca34991b6f6a284">00335</a>         <a class="code" href="classgalsim_1_1_nearest.html#ab73d3adcb493f8639ca34991b6f6a284">~Nearest</a>() {}
<a name="l00336"></a>00336 
<a name="l00337"></a><a class="code" href="classgalsim_1_1_nearest.html#a543b0fa85a5bd1b2ae9e13f6c785a596">00337</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_nearest.html#a543b0fa85a5bd1b2ae9e13f6c785a596" title="Maximum extent of interpolant from origin in x space (pixels).">xrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0.5; }
<a name="l00338"></a><a class="code" href="classgalsim_1_1_nearest.html#ad2b482d25e8028b52c072ede9b42df52">00338</a>         <span class="keywordtype">int</span> <a class="code" href="classgalsim_1_1_nearest.html#ad2b482d25e8028b52c072ede9b42df52" title="The total range as an integer. Typically xrange() == 0.5 * ixrange().">ixrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1; }
<a name="l00339"></a><a class="code" href="classgalsim_1_1_nearest.html#a9e9f642d8c6da8bd3cfce5f9f7d70a5c">00339</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_nearest.html#a9e9f642d8c6da8bd3cfce5f9f7d70a5c" title="Maximum extent of interpolant from origin in u space (cycles per pixel).">urange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1./(M_PI*_tolerance); }
<a name="l00340"></a><a class="code" href="classgalsim_1_1_nearest.html#a1eedbe8d5f1d5d7a9f62ffe924ed213c">00340</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_nearest.html#a1eedbe8d5f1d5d7a9f62ffe924ed213c" title="Report a generic indication of the accuracy to which Interpolant is calculated.">getTolerance</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _tolerance; }
<a name="l00341"></a>00341 
<a name="l00342"></a>00342         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_nearest.html#a264448fef44bb92332ae337269251d38" title="Value of interpolant in real space.">xval</a>(<span class="keywordtype">double</span> x) <span class="keyword">const</span>;
<a name="l00343"></a>00343         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_nearest.html#a7bf7a20c0ab95f59a99929f0729eabdf" title="Value of interpolant in frequency space.">uval</a>(<span class="keywordtype">double</span> u) <span class="keyword">const</span>;
<a name="l00344"></a>00344 
<a name="l00345"></a>00345         <span class="comment">// Override the default numerical photon-shooting method</span>
<a name="l00346"></a><a class="code" href="classgalsim_1_1_nearest.html#a6b822674e72201704337682fec9d0941">00346</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_nearest.html#a6b822674e72201704337682fec9d0941" title="Return the integral of the positive portions of the kernel.">getPositiveFlux</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1.; }
<a name="l00347"></a><a class="code" href="classgalsim_1_1_nearest.html#ad7e34bb97a08253f806c854c6aa12e3b">00347</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_nearest.html#ad7e34bb97a08253f806c854c6aa12e3b" title="Return the (absolute value of) integral of the negative portions of the kernel.">getNegativeFlux</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0.; }
<a name="l00348"></a>00348         boost::shared_ptr&lt;PhotonArray&gt; <a class="code" href="classgalsim_1_1_nearest.html#a343e4a256308b37d9ec596cf444e16f1" title="Return array of displacements drawn from this kernel.">shoot</a>(<span class="keywordtype">int</span> N, <a class="code" href="classgalsim_1_1_uniform_deviate.html" title="Pseudo-random number generator with uniform distribution in interval [0.,1.).">UniformDeviate</a> ud) <span class="keyword">const</span>;
<a name="l00349"></a>00349 
<a name="l00350"></a>00350     <span class="keyword">private</span>:
<a name="l00351"></a>00351         <span class="keywordtype">double</span> _tolerance;
<a name="l00352"></a>00352     };
<a name="l00353"></a>00353 
<a name="l00364"></a><a class="code" href="classgalsim_1_1_sinc_interpolant.html">00364</a>     <span class="keyword">class </span><a class="code" href="classgalsim_1_1_sinc_interpolant.html" title="Sinc interpolation: inverse of Nearest-neighbor.">SincInterpolant</a> : <span class="keyword">public</span> <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a> 
<a name="l00365"></a>00365     {
<a name="l00366"></a>00366     <span class="keyword">public</span>:
<a name="l00374"></a><a class="code" href="classgalsim_1_1_sinc_interpolant.html#ab01737f1dae1f59a0b85428953201804">00374</a>         <a class="code" href="classgalsim_1_1_sinc_interpolant.html#ab01737f1dae1f59a0b85428953201804" title="Constructor.">SincInterpolant</a>(<span class="keywordtype">double</span> tol=1.e-3, <span class="keyword">const</span> <a class="code" href="structgalsim_1_1_g_s_params_ptr.html">GSParamsPtr</a>&amp; gsparams=<a class="code" href="structgalsim_1_1_g_s_params_ptr.html#acbdc82aaaa6f7e7245f2996da8045d2b">GSParamsPtr::getDefault</a>()) :
<a name="l00375"></a>00375             <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a>(gsparams), _tolerance(tol) {}
<a name="l00376"></a><a class="code" href="classgalsim_1_1_sinc_interpolant.html#ad8d0937f6f47cc256bc9980c88fda1ca">00376</a>         <a class="code" href="classgalsim_1_1_sinc_interpolant.html#ad8d0937f6f47cc256bc9980c88fda1ca">~SincInterpolant</a>() {}
<a name="l00377"></a>00377 
<a name="l00378"></a><a class="code" href="classgalsim_1_1_sinc_interpolant.html#af1caa3866616310b4351ac2e078d2259">00378</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_sinc_interpolant.html#af1caa3866616310b4351ac2e078d2259" title="Maximum extent of interpolant from origin in x space (pixels).">xrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1./(M_PI*_tolerance); }
<a name="l00379"></a><a class="code" href="classgalsim_1_1_sinc_interpolant.html#a9f806effdc0244f8e6d7e184776f8f91">00379</a>         <span class="keywordtype">int</span> <a class="code" href="classgalsim_1_1_sinc_interpolant.html#a9f806effdc0244f8e6d7e184776f8f91" title="The total range as an integer. Typically xrange() == 0.5 * ixrange().">ixrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0; }
<a name="l00380"></a><a class="code" href="classgalsim_1_1_sinc_interpolant.html#a0cfbcc35e7f7ade5d2d9862981afd0db">00380</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_sinc_interpolant.html#a0cfbcc35e7f7ade5d2d9862981afd0db" title="Maximum extent of interpolant from origin in u space (cycles per pixel).">urange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0.5; }
<a name="l00381"></a><a class="code" href="classgalsim_1_1_sinc_interpolant.html#a10e29a9c5af80c5b5e5333c939840da8">00381</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_sinc_interpolant.html#a10e29a9c5af80c5b5e5333c939840da8" title="Report a generic indication of the accuracy to which Interpolant is calculated.">getTolerance</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _tolerance; }
<a name="l00382"></a>00382 
<a name="l00383"></a>00383         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_sinc_interpolant.html#af222b5d8ff914eba5e069671252baac6" title="Value of interpolant in real space.">xval</a>(<span class="keywordtype">double</span> x) <span class="keyword">const</span>;
<a name="l00384"></a>00384         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_sinc_interpolant.html#a2a6de88171a67da808553dc715eaf472" title="Value of interpolant, wrapped at period N.">xvalWrapped</a>(<span class="keywordtype">double</span> x, <span class="keywordtype">int</span> N) <span class="keyword">const</span>;
<a name="l00385"></a>00385         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_sinc_interpolant.html#a1ec01422c820080cf16c7db0760117c5" title="Value of interpolant in frequency space.">uval</a>(<span class="keywordtype">double</span> u) <span class="keyword">const</span>;
<a name="l00386"></a>00386 
<a name="l00387"></a>00387         boost::shared_ptr&lt;PhotonArray&gt; <a class="code" href="classgalsim_1_1_sinc_interpolant.html#aba07b4a0756c3b0e19577bb1ccc99c72" title="Return array of displacements drawn from this kernel.">shoot</a>(<span class="keywordtype">int</span> N, <a class="code" href="classgalsim_1_1_uniform_deviate.html" title="Pseudo-random number generator with uniform distribution in interval [0.,1.).">UniformDeviate</a> ud) <span class="keyword">const</span>;
<a name="l00388"></a>00388 
<a name="l00389"></a>00389     <span class="keyword">private</span>:
<a name="l00390"></a>00390         <span class="keywordtype">double</span> _tolerance;
<a name="l00391"></a>00391     };
<a name="l00392"></a>00392 
<a name="l00402"></a><a class="code" href="classgalsim_1_1_linear.html">00402</a>     <span class="keyword">class </span><a class="code" href="classgalsim_1_1_linear.html" title="Linear interpolant.">Linear</a> : <span class="keyword">public</span> <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a> 
<a name="l00403"></a>00403     {
<a name="l00404"></a>00404     <span class="keyword">public</span>:
<a name="l00412"></a><a class="code" href="classgalsim_1_1_linear.html#abe76e014b8ac22aa0b309ae0700e34f1">00412</a>         <a class="code" href="classgalsim_1_1_linear.html#abe76e014b8ac22aa0b309ae0700e34f1" title="Constructor.">Linear</a>(<span class="keywordtype">double</span> tol=1.e-3, <span class="keyword">const</span> <a class="code" href="structgalsim_1_1_g_s_params_ptr.html">GSParamsPtr</a>&amp; gsparams=<a class="code" href="structgalsim_1_1_g_s_params_ptr.html#acbdc82aaaa6f7e7245f2996da8045d2b">GSParamsPtr::getDefault</a>()) :
<a name="l00413"></a>00413             <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a>(gsparams), _tolerance(tol) {}
<a name="l00414"></a><a class="code" href="classgalsim_1_1_linear.html#a260c1f6304795d70b361d7e0e68bb021">00414</a>         <a class="code" href="classgalsim_1_1_linear.html#a260c1f6304795d70b361d7e0e68bb021">~Linear</a>() {}
<a name="l00415"></a>00415 
<a name="l00416"></a><a class="code" href="classgalsim_1_1_linear.html#a5ac3a7f5473fbaa75ecddc31776ad8e3">00416</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_linear.html#a5ac3a7f5473fbaa75ecddc31776ad8e3" title="Maximum extent of interpolant from origin in x space (pixels).">xrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1.-0.5*_tolerance; }  <span class="comment">// Snip off endpoints near zero</span>
<a name="l00417"></a><a class="code" href="classgalsim_1_1_linear.html#a4d6434d22b50f5575b35310876b233e3">00417</a>         <span class="keywordtype">int</span> <a class="code" href="classgalsim_1_1_linear.html#a4d6434d22b50f5575b35310876b233e3" title="The total range as an integer. Typically xrange() == 0.5 * ixrange().">ixrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 2; }
<a name="l00418"></a><a class="code" href="classgalsim_1_1_linear.html#a533313b67ee80f96e95fd340707dcd5a">00418</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_linear.html#a533313b67ee80f96e95fd340707dcd5a" title="Maximum extent of interpolant from origin in u space (cycles per pixel).">urange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> std::sqrt(1./_tolerance)/M_PI; }
<a name="l00419"></a><a class="code" href="classgalsim_1_1_linear.html#ab31cfdb97d827e86768afa84e24c1e2a">00419</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_linear.html#ab31cfdb97d827e86768afa84e24c1e2a" title="Report a generic indication of the accuracy to which Interpolant is calculated.">getTolerance</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _tolerance; }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_linear.html#a5767343b52b7700cc670bfd2c7f9f2e2" title="Value of interpolant in real space.">xval</a>(<span class="keywordtype">double</span> x) <span class="keyword">const</span>;
<a name="l00422"></a>00422         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_linear.html#a08170a2a56aa370647dd371b20fbc24c" title="Value of interpolant in frequency space.">uval</a>(<span class="keywordtype">double</span> u) <span class="keyword">const</span>;
<a name="l00423"></a>00423 
<a name="l00424"></a>00424         <span class="comment">// Override the default numerical photon-shooting method</span>
<a name="l00425"></a><a class="code" href="classgalsim_1_1_linear.html#acde3de0e8020d757f55c5ecd0490acf4">00425</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_linear.html#acde3de0e8020d757f55c5ecd0490acf4" title="Return the integral of the positive portions of the kernel.">getPositiveFlux</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1.; }
<a name="l00426"></a><a class="code" href="classgalsim_1_1_linear.html#a8f39902af930f9b4d83c621e46fdb80e">00426</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_linear.html#a8f39902af930f9b4d83c621e46fdb80e" title="Return the (absolute value of) integral of the negative portions of the kernel.">getNegativeFlux</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 0.; }
<a name="l00427"></a>00427         <span class="comment">// Linear interpolant has fast photon-shooting by adding two uniform deviates per</span>
<a name="l00428"></a>00428         boost::shared_ptr&lt;PhotonArray&gt; <a class="code" href="classgalsim_1_1_linear.html#a2763d9b1a8d11fb43965fc7cdcd2da98" title="Return array of displacements drawn from this kernel.">shoot</a>(<span class="keywordtype">int</span> N, <a class="code" href="classgalsim_1_1_uniform_deviate.html" title="Pseudo-random number generator with uniform distribution in interval [0.,1.).">UniformDeviate</a> ud) <span class="keyword">const</span>;
<a name="l00429"></a>00429 
<a name="l00430"></a>00430     <span class="keyword">private</span>:
<a name="l00431"></a>00431         <span class="keywordtype">double</span> _tolerance;
<a name="l00432"></a>00432     };
<a name="l00433"></a>00433 
<a name="l00442"></a><a class="code" href="classgalsim_1_1_cubic.html">00442</a>     <span class="keyword">class </span><a class="code" href="classgalsim_1_1_cubic.html" title="Cubic interpolator exact to 3rd order Taylor expansion.">Cubic</a> : <span class="keyword">public</span> <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a> 
<a name="l00443"></a>00443     {
<a name="l00444"></a>00444     <span class="keyword">public</span>:
<a name="l00452"></a>00452         <a class="code" href="classgalsim_1_1_cubic.html#abbb944dd5d87d9e9b658b479f30f114b" title="Constructor.">Cubic</a>(<span class="keywordtype">double</span> tol=1.e-4, <span class="keyword">const</span> <a class="code" href="structgalsim_1_1_g_s_params_ptr.html">GSParamsPtr</a>&amp; gsparams=<a class="code" href="structgalsim_1_1_g_s_params_ptr.html#acbdc82aaaa6f7e7245f2996da8045d2b">GSParamsPtr::getDefault</a>());
<a name="l00453"></a><a class="code" href="classgalsim_1_1_cubic.html#adac20a5f09df58cc9f46a24cb697092b">00453</a>         <a class="code" href="classgalsim_1_1_cubic.html#adac20a5f09df58cc9f46a24cb697092b">~Cubic</a>() {}
<a name="l00454"></a>00454 
<a name="l00455"></a><a class="code" href="classgalsim_1_1_cubic.html#a67fa5497b208ee1c7921275838aac812">00455</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_cubic.html#a67fa5497b208ee1c7921275838aac812" title="Maximum extent of interpolant from origin in x space (pixels).">xrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _range; }
<a name="l00456"></a><a class="code" href="classgalsim_1_1_cubic.html#aaeb651886220693a112cae0e90f1fc7c">00456</a>         <span class="keywordtype">int</span> <a class="code" href="classgalsim_1_1_cubic.html#aaeb651886220693a112cae0e90f1fc7c" title="The total range as an integer. Typically xrange() == 0.5 * ixrange().">ixrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 4; }
<a name="l00457"></a><a class="code" href="classgalsim_1_1_cubic.html#a5b9aeb17f8aa0f95e8966206dcf7fef5">00457</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_cubic.html#a5b9aeb17f8aa0f95e8966206dcf7fef5" title="Maximum extent of interpolant from origin in u space (cycles per pixel).">urange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _uMax; }
<a name="l00458"></a><a class="code" href="classgalsim_1_1_cubic.html#a538d4cf360835b1c6a557dd05314adc9">00458</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_cubic.html#a538d4cf360835b1c6a557dd05314adc9" title="Report a generic indication of the accuracy to which Interpolant is calculated.">getTolerance</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _tolerance; }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_cubic.html#a373a9edc0d8ab8391989dcad5d272a9a" title="Value of interpolant in real space.">xval</a>(<span class="keywordtype">double</span> x) <span class="keyword">const</span>;
<a name="l00461"></a>00461         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_cubic.html#a16683e6a3ddf9a0fab2de7e1e972c930" title="Value of interpolant in frequency space.">uval</a>(<span class="keywordtype">double</span> u) <span class="keyword">const</span>;
<a name="l00462"></a>00462 
<a name="l00463"></a>00463         <span class="comment">// Override numerical calculation with known analytic integral</span>
<a name="l00464"></a><a class="code" href="classgalsim_1_1_cubic.html#abc0af2e26bc6d4e47d537d14d5b3ac8c">00464</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_cubic.html#abc0af2e26bc6d4e47d537d14d5b3ac8c" title="Return the integral of the positive portions of the kernel.">getPositiveFlux</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 13./12.; }
<a name="l00465"></a><a class="code" href="classgalsim_1_1_cubic.html#ab80330b057332e5d0fe0fbee2067b62c">00465</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_cubic.html#ab80330b057332e5d0fe0fbee2067b62c" title="Return the (absolute value of) integral of the negative portions of the kernel.">getNegativeFlux</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 1./12.; }
<a name="l00466"></a>00466 
<a name="l00467"></a>00467     <span class="keyword">private</span>:
<a name="l00468"></a>00468         <span class="comment">// x range, reduced slightly from n=2 so we&apos;re not using zero-valued endpoints.</span>
<a name="l00469"></a>00469         <span class="keywordtype">double</span> _range; 
<a name="l00470"></a>00470 
<a name="l00471"></a>00471         <span class="keywordtype">double</span> _tolerance;    
<a name="l00472"></a>00472         boost::shared_ptr&lt;Table&lt;double,double&gt; &gt; _tab; <span class="comment">// Tabulated Fourier transform</span>
<a name="l00473"></a>00473         <span class="keywordtype">double</span> _uMax;  <span class="comment">// Truncation point for Fourier transform</span>
<a name="l00474"></a>00474 
<a name="l00475"></a>00475         <span class="comment">// Calculate the FT from a direct integration.</span>
<a name="l00476"></a>00476         <span class="keywordtype">double</span> uCalc(<span class="keywordtype">double</span> u) <span class="keyword">const</span>;
<a name="l00477"></a>00477 
<a name="l00478"></a>00478         <span class="comment">// Store the tables in a map, so repeat constructions are quick.</span>
<a name="l00479"></a>00479         <span class="keyword">static</span> std::map&lt;double,boost::shared_ptr&lt;Table&lt;double,double&gt; &gt; &gt; _cache_tab; 
<a name="l00480"></a>00480         <span class="keyword">static</span> std::map&lt;double,double&gt; _cache_umax; 
<a name="l00481"></a>00481     };
<a name="l00482"></a>00482 
<a name="l00489"></a><a class="code" href="classgalsim_1_1_quintic.html">00489</a>     <span class="keyword">class </span><a class="code" href="classgalsim_1_1_quintic.html" title="Piecewise-quintic polynomial interpolant, ideal for Fourier-space interpolation.">Quintic</a> : <span class="keyword">public</span> <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a> 
<a name="l00490"></a>00490     {
<a name="l00491"></a>00491     <span class="keyword">public</span>:
<a name="l00498"></a>00498         <a class="code" href="classgalsim_1_1_quintic.html#ae58990f7bb455f11738271bbee3420fb" title="Constructor.">Quintic</a>(<span class="keywordtype">double</span> tol=1.e-4, <span class="keyword">const</span> <a class="code" href="structgalsim_1_1_g_s_params_ptr.html">GSParamsPtr</a>&amp; gsparams=<a class="code" href="structgalsim_1_1_g_s_params_ptr.html#acbdc82aaaa6f7e7245f2996da8045d2b">GSParamsPtr::getDefault</a>());
<a name="l00499"></a><a class="code" href="classgalsim_1_1_quintic.html#a867d1b1a35c46bb0f9e8fdf83b994f3e">00499</a>         <a class="code" href="classgalsim_1_1_quintic.html#a867d1b1a35c46bb0f9e8fdf83b994f3e">~Quintic</a>() {}
<a name="l00500"></a>00500 
<a name="l00501"></a><a class="code" href="classgalsim_1_1_quintic.html#a7d04f9e48a7aeee1cede8367b2ffd621">00501</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_quintic.html#a7d04f9e48a7aeee1cede8367b2ffd621" title="Maximum extent of interpolant from origin in x space (pixels).">xrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _range; }
<a name="l00502"></a><a class="code" href="classgalsim_1_1_quintic.html#a113dadeadc51e2bbfd1da1b1c1629305">00502</a>         <span class="keywordtype">int</span> <a class="code" href="classgalsim_1_1_quintic.html#a113dadeadc51e2bbfd1da1b1c1629305" title="The total range as an integer. Typically xrange() == 0.5 * ixrange().">ixrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 6; }
<a name="l00503"></a><a class="code" href="classgalsim_1_1_quintic.html#a5a00c7066568f7b1a751e54c62f802a9">00503</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_quintic.html#a5a00c7066568f7b1a751e54c62f802a9" title="Maximum extent of interpolant from origin in u space (cycles per pixel).">urange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _uMax; }
<a name="l00504"></a><a class="code" href="classgalsim_1_1_quintic.html#a9862837910db5c8ee18f3fde4972ed82">00504</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_quintic.html#a9862837910db5c8ee18f3fde4972ed82" title="Report a generic indication of the accuracy to which Interpolant is calculated.">getTolerance</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _tolerance; }
<a name="l00505"></a>00505 
<a name="l00506"></a>00506         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_quintic.html#a898d54f7ef9b531429f3be0caff16429" title="Value of interpolant in real space.">xval</a>(<span class="keywordtype">double</span> x) <span class="keyword">const</span>;
<a name="l00507"></a>00507         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_quintic.html#ae75931c830d053f94113463b5c118e13" title="Value of interpolant in frequency space.">uval</a>(<span class="keywordtype">double</span> u) <span class="keyword">const</span>;
<a name="l00508"></a>00508 
<a name="l00509"></a>00509     <span class="keyword">protected</span>:
<a name="l00510"></a>00510         <span class="comment">// Override default sampler configuration because Quintic filter has sign change in</span>
<a name="l00511"></a>00511         <span class="comment">// outer interval</span>
<a name="l00512"></a>00512         <span class="keywordtype">void</span> checkSampler() <span class="keyword">const</span>;
<a name="l00513"></a>00513 
<a name="l00514"></a>00514     <span class="keyword">private</span>:
<a name="l00515"></a>00515         <span class="keywordtype">double</span> _range; <span class="comment">// Reduce range slightly from n so we&apos;re not using zero-valued endpoints.</span>
<a name="l00516"></a>00516         <span class="keywordtype">double</span> _tolerance;    
<a name="l00517"></a>00517         boost::shared_ptr&lt;Table&lt;double,double&gt; &gt; _tab; <span class="comment">// Tabulated Fourier transform</span>
<a name="l00518"></a>00518         <span class="keywordtype">double</span> _uMax;  <span class="comment">// Truncation point for Fourier transform</span>
<a name="l00519"></a>00519 
<a name="l00520"></a>00520         <span class="comment">// Calculate the FT from a direct integration.</span>
<a name="l00521"></a>00521         <span class="keywordtype">double</span> uCalc(<span class="keywordtype">double</span> u) <span class="keyword">const</span>;
<a name="l00522"></a>00522 
<a name="l00523"></a>00523         <span class="comment">// Store the tables in a map, so repeat constructions are quick.</span>
<a name="l00524"></a>00524         <span class="keyword">static</span> std::map&lt;double,boost::shared_ptr&lt;Table&lt;double,double&gt; &gt; &gt; _cache_tab; 
<a name="l00525"></a>00525         <span class="keyword">static</span> std::map&lt;double,double&gt; _cache_umax; 
<a name="l00526"></a>00526     };
<a name="l00527"></a>00527 
<a name="l00545"></a><a class="code" href="classgalsim_1_1_lanczos.html">00545</a>     <span class="keyword">class </span><a class="code" href="classgalsim_1_1_lanczos.html" title="The Lanczos interpolation filter, nominally sinc(x)*sinc(x/n), truncated at +/-n...">Lanczos</a> : <span class="keyword">public</span> <a class="code" href="classgalsim_1_1_interpolant.html" title="Base class representing one-dimensional interpolant functions.">Interpolant</a> 
<a name="l00546"></a>00546     {
<a name="l00547"></a>00547     <span class="keyword">public</span>:
<a name="l00558"></a>00558         <a class="code" href="classgalsim_1_1_lanczos.html#a36bbda9d2857dddee90f29aee2ee2656" title="Constructor.">Lanczos</a>(<span class="keywordtype">int</span> n, <span class="keywordtype">bool</span> conserve_dc=<span class="keyword">true</span>, <span class="keywordtype">double</span> tol=1.e-4, 
<a name="l00559"></a>00559                 <span class="keyword">const</span> <a class="code" href="structgalsim_1_1_g_s_params_ptr.html">GSParamsPtr</a>&amp; gsparams=<a class="code" href="structgalsim_1_1_g_s_params_ptr.html#acbdc82aaaa6f7e7245f2996da8045d2b">GSParamsPtr::getDefault</a>());
<a name="l00560"></a><a class="code" href="classgalsim_1_1_lanczos.html#af47e14f83b5aaca3bdfc395f3016fe26">00560</a>         <a class="code" href="classgalsim_1_1_lanczos.html#af47e14f83b5aaca3bdfc395f3016fe26">~Lanczos</a>() {}
<a name="l00561"></a>00561 
<a name="l00562"></a><a class="code" href="classgalsim_1_1_lanczos.html#a9251298f474d97c2b07bfb5aab06bc07">00562</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_lanczos.html#a9251298f474d97c2b07bfb5aab06bc07" title="Maximum extent of interpolant from origin in x space (pixels).">xrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _range; }
<a name="l00563"></a><a class="code" href="classgalsim_1_1_lanczos.html#a00f5da7bb3b9aa4193b4cb308c55936f">00563</a>         <span class="keywordtype">int</span> <a class="code" href="classgalsim_1_1_lanczos.html#a00f5da7bb3b9aa4193b4cb308c55936f" title="The total range as an integer. Typically xrange() == 0.5 * ixrange().">ixrange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 2*_n; }
<a name="l00564"></a><a class="code" href="classgalsim_1_1_lanczos.html#af3c8d755714dd342d53cfbc53a859222">00564</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_lanczos.html#af3c8d755714dd342d53cfbc53a859222" title="Maximum extent of interpolant from origin in u space (cycles per pixel).">urange</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _uMax; }
<a name="l00565"></a><a class="code" href="classgalsim_1_1_lanczos.html#ac7c39f443245fae99993433b5d0725b5">00565</a>         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_lanczos.html#ac7c39f443245fae99993433b5d0725b5" title="Report a generic indication of the accuracy to which Interpolant is calculated.">getTolerance</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> _tolerance; }
<a name="l00566"></a>00566 
<a name="l00567"></a>00567         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_lanczos.html#acb373540f0ce2fe47d80dee405b119ed" title="Value of interpolant in real space.">xval</a>(<span class="keywordtype">double</span> x) <span class="keyword">const</span>;
<a name="l00568"></a>00568         <span class="keywordtype">double</span> <a class="code" href="classgalsim_1_1_lanczos.html#aba8b586930d579b0dda1d7d5fc967008" title="Value of interpolant in frequency space.">uval</a>(<span class="keywordtype">double</span> u) <span class="keyword">const</span>;
<a name="l00569"></a>00569 
<a name="l00570"></a>00570     <span class="keyword">private</span>:
<a name="l00571"></a>00571         <span class="keywordtype">int</span> _n; <span class="comment">// Store the filter order, n</span>
<a name="l00572"></a>00572         <span class="keywordtype">double</span> _nd; <span class="comment">// Store n as a double, since that&apos;s often how it is used.</span>
<a name="l00573"></a>00573         <span class="keywordtype">double</span> _range; <span class="comment">// Reduce range slightly from n so we&apos;re not using zero-valued endpoints.</span>
<a name="l00574"></a>00574         <span class="keywordtype">bool</span> _conserve_dc; <span class="comment">// Set to insure conservation of constant (sky) flux</span>
<a name="l00575"></a>00575         <span class="keywordtype">double</span> _tolerance;  <span class="comment">// u-space accuracy parameter</span>
<a name="l00576"></a>00576         <span class="keywordtype">double</span> _uMax;  <span class="comment">// truncation point for Fourier transform</span>
<a name="l00577"></a>00577         std::vector&lt;double&gt; _K; <span class="comment">// coefficients for flux correction in xval</span>
<a name="l00578"></a>00578         std::vector&lt;double&gt; _C; <span class="comment">// coefficients for flux correction in uval</span>
<a name="l00579"></a>00579         boost::shared_ptr&lt;Table&lt;double,double&gt; &gt; _xtab; <span class="comment">// Table for x values</span>
<a name="l00580"></a>00580         boost::shared_ptr&lt;Table&lt;double,double&gt; &gt; _utab; <span class="comment">// Table for Fourier transform</span>
<a name="l00581"></a>00581 
<a name="l00582"></a>00582         <span class="keywordtype">double</span> xCalc(<span class="keywordtype">double</span> x) <span class="keyword">const</span>;
<a name="l00583"></a>00583         <span class="keywordtype">double</span> uCalc(<span class="keywordtype">double</span> u) <span class="keyword">const</span>;
<a name="l00584"></a>00584         <span class="keywordtype">double</span> uCalcRaw(<span class="keywordtype">double</span> u) <span class="keyword">const</span>; <span class="comment">// uCalc without any flux conservation.</span>
<a name="l00585"></a>00585 
<a name="l00586"></a>00586         <span class="comment">// Store the tables in a map, so repeat constructions are quick.</span>
<a name="l00587"></a>00587         <span class="keyword">typedef</span> std::pair&lt;int,std::pair&lt;bool,double&gt; &gt; KeyType;
<a name="l00588"></a>00588         <span class="keyword">static</span> std::map&lt;KeyType,boost::shared_ptr&lt;Table&lt;double,double&gt; &gt; &gt; _cache_xtab; 
<a name="l00589"></a>00589         <span class="keyword">static</span> std::map&lt;KeyType,boost::shared_ptr&lt;Table&lt;double,double&gt; &gt; &gt; _cache_utab; 
<a name="l00590"></a>00590         <span class="keyword">static</span> std::map&lt;KeyType,double&gt; _cache_umax; 
<a name="l00591"></a>00591     };
<a name="l00592"></a>00592 
<a name="l00593"></a>00593 }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595 <span class="preprocessor">#endif //INTERPOLANT_H</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>
Generated for GalSim by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1</small></address>
</body>
</html>
