some_variables :
    n_gals_in_cat : &n_gals_in_cat 2
    n_trials_per_iter : &n_trials_per_iter 32

compare_dft_vs_photon_config :
    abs_tol_ellip : 1e-3
    abs_tol_size :  1e-3
    n_trials_per_iter : 32 
    n_photons_per_trial : 1e6

psf : 
    # ground PSF
    type : Convolution
    items :  
        - { type : Moffat, fwhm : 0.65, beta : 3 }
        - { type : Airy, lam_over_diam : {type: Eval, str: '(700.e-9)/4*180/math.pi*3600'} }
    ellip : 
        type : EBeta
        e : { type : InputCatalog , col : 7,  index : { type: Sequence, repeat: *n_trials_per_iter} }  
        beta : { type: Deg , theta : {type : InputCatalog , col : 8 , index : { type: Sequence, repeat: *n_trials_per_iter} } }
        
gal :
    type : Sersic
    half_light_radius : { type : InputCatalog , col : 2,  index : { type: Sequence, repeat: *n_trials_per_iter} }
    n : { type : InputCatalog , col : 1,  index : { type: Sequence, repeat: *n_trials_per_iter} }
    ellip : 
        type : GBeta 
        g : { type : InputCatalog , col : 3,  index : { type: Sequence, repeat: *n_trials_per_iter} }  
        beta : { type: Rad , theta : { type : InputCatalog , col : 3,  index : { type: Sequence, repeat: *n_trials_per_iter} } }
    shift : 
            type : XY  
            x : { type : InputCatalog , col : 5 , index : { type: Sequence, repeat: *n_trials_per_iter} }
            y : { type : InputCatalog , col : 6 , index : { type: Sequence, repeat: *n_trials_per_iter} }
    
image :
    # wmult : 4.0
    random_seed : 1929392
    nproc : 2
    # pixel scale for the ground observation
    pixel_scale : 0.2  # arcsec / pixel
    type : Single
    # nx_tiles : 1
    # ny_tiles : *n_gals_in_cat
    # # this has to be big in order for the space images to contain the galaxies fully
    size : 128
    # stamp_size : 128
    # this field is required for the photon image, 
    # but we don't want to add any noise, so we set the variance to 0
    noise :
        type : Gaussian
        sigma : 0.         
    # at this point specify the defaults, but if has to be specified here if will be changed later
    # using vary_params
    gsparams :
         minimum_fft_size : 128      
         maximum_fft_size : 50000     
         alias_threshold : 5.e-3     
         maxk_threshold : 1.e-3      
         kvalue_accuracy : 1.e-5     
         xvalue_accuracy : 1.e-5     
         shoot_accuracy : 1.e-5      
         realspace_relerr : 1.e-3    
         realspace_abserr : 1.e-6    
         integration_relerr : 1.e-5  
         integration_abserr : 1.e-7  

input :
    catalog :
        dir : .
        file_name : cosmos_sersics_sample_N300_cleaned.asc

output:
    type: MultiFits
    nimages: *n_gals_in_cat

# added for the purpose of the photon_vs_fft
# photon_vs_fft will run once for each value of each listed parameter
# the results for the input galaxies will be saved to a file with a name
# 'results.yaml_filename.param_name.param_index.cat'
# later other scripts can be used to produce plots
run_default: False
vary_params:
    alias_threshold : 
        path : ['image','gsparams','alias_threshold']
        values : [ 1.0e-1 , 5.0e-4 ]
        rebuild_photon : False 
    maxk_threshold :   
        path : ['image','gsparams','maxk_threshold' ] 
        values : [ 1.0e-1 , 1.0e-5 ]  
        rebuild_photon : False
    kvalue_accuracy : 
        path : ['image','gsparams','kvalue_accuracy']
        values : [ 1.0e-3 , 1.0e-8 ] 
        rebuild_photon : False 
