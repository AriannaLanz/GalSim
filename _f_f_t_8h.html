<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>GalSim: include/galsim/FFT.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>include/galsim/FFT.h File Reference</h1>
<p>Objects that make use of 2d FFT's in VERSION 3 of the FFTW package.  
<a href="#_details">More...</a></p>
<code>#include &lt;stdexcept&gt;</code><br/>
<code>#include &lt;deque&gt;</code><br/>
<code>#include &lt;complex&gt;</code><br/>
<code>#include &lt;boost/shared_ptr.hpp&gt;</code><br/>
<code>#include &quot;fftw3.h&quot;</code><br/>
<code>#include &quot;Std.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="_interpolant_8h_source.html">Interpolant.h</a>&quot;</code><br/>

<p><a href="_f_f_t_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1_k_table.html">galsim.KTable</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classgalsim_1_1_k_table.html" title="KTable is a class holding the k-space representation of a real function.">KTable</a> is a class holding the k-space representation of a <a class="el" href="namespacegalsim_1_1real.html">real</a> function.  <a href="classgalsim_1_1_k_table.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgalsim_1_1_x_table.html">galsim.XTable</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classgalsim_1_1_x_table.html" title="XTable is a class holding a lookup table of a real 2-d function.">XTable</a> is a class holding a lookup <a class="el" href="namespacegalsim_1_1table.html">table</a> of a <a class="el" href="namespacegalsim_1_1real.html">real</a> 2-d function.  <a href="classgalsim_1_1_x_table.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Packages</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">package &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim.html">galsim</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="_f_f_t_8h.html#ae23b24e85d04f74fdebd21fe0cc0ebcf">BOOST_NO_CXX11_SMART_PTR</a></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacegalsim.html#a1b07104b75adb92285c0a06c62776ae5">galsim.goodFFTSize</a> (int input)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">A helper function that will return the smallest 2^n or 3x2^n value that is even and &gt;= the input integer.  <a href="#a1b07104b75adb92285c0a06c62776ae5"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Objects that make use of 2d FFT's in VERSION 3 of the FFTW package. </p>
<p>Notes:</p>
<p>* Requires that the FFTW is set up to do double-precision.</p>
<p>* All tables have even dimensions (enforced on construction).</p>
<p>* The complex arrays (KTables) must be Hermitian, so transforms are real.</p>
<p>* All arrays are 0-indexed.</p>
<p>* FFTW arrays are stored in ROW-MAJOR order, meaning that in matrix notation, the most rapidly varying index is the last one. However in an "image" view of the array, we would label this as the x value that is increasing along rows. When doing real-to-complex transforms, the complex output contains (N/2+1) elements along this latter index, 0&lt;=j&lt;=N/2, and the j&lt;0 elements must be obtained via conjugation. Imaginary parts of 0 and N/2 are zero.</p>
<p>* This interface will assume an "image" based convention in which all access to real or complex elements is in (ix, iy) format, and ix will be the rapidly varying index, with the k-space arrays being half-sized in the x direction.</p>
<p>* **SO**: when filling arrays, make ix your inner loop. And provide only kx&gt;=0 to fill KTable.</p>
<p>* xTable arrays have indices -N/2 &lt;= ix,iy &lt; N/2. To store in FFTW arrays, which assume 0&lt;=j &lt; N, we add N/2 to indices before accessing FFTW arrays. This means that k values need to be multiplied by -1^(ix+iy) before/after transforms.</p>
<p>* kTable arrays can be accessed by -N/2 &lt;= jx, jy &lt;= N/2. FFTW puts DC at [0,0] element, so the code in this class changes negative input indices to wrap them properly, also considering that jx&lt;0 must be conjugated.</p>
<p>* "forward" transform, x-&gt;k, has -1 in exponent. </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ae23b24e85d04f74fdebd21fe0cc0ebcf"></a><!-- doxytag: member="FFT.h::BOOST_NO_CXX11_SMART_PTR" ref="ae23b24e85d04f74fdebd21fe0cc0ebcf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BOOST_NO_CXX11_SMART_PTR</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>
Generated for GalSim by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1</small></address>
</body>
</html>
